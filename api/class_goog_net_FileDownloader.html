<!DOCTYPE html><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"><meta http-equiv="Content-Language" content="en"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>FileDownloader</title><link href="dossier.css" rel="stylesheet" type="text/css"><header><div><form><div><input type="search" placeholder="Search"></div></form></div></header><main><article><div class="parentlink"><b>Namespace:</b> <a href="namespace_goog_net.html">goog.net</a></div><div class="codelink"><a href="source/closure/goog/net/filedownloader.js.src.html#l70">View Source</a></div><h1>class FileDownloader</h1><div class="tags"><span>final</span></div><pre class="inheritance"><a href="class_goog_Disposable.html">goog.Disposable</a>
  &#x2514; goog.net.FileDownloader</pre><dl><dt>All implemented interfaces:<dd><code><a href="interface_goog_disposable_IDisposable.html">goog.disposable.IDisposable</a></code></dl><p>A class for downloading remote files and storing them locally using the HTML5 filesystem API.</p><h2 class="main">new FileDownloader(<wbr>dir, opt_pool)</h2><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>dir<code><a href="interface_goog_fs_DirectoryEntry.html">goog.fs.DirectoryEntry</a></code><dd><p>The directory in which the downloaded  files are stored. This directory should be solely managed by  FileDownloader.</p><dt>opt_pool<code>?<a href="class_goog_net_XhrIoPool.html">goog.net.XhrIoPool</a>=</code><dd><p>The pool of XhrIo objects to use for  downloading files.</p></dl></div></div><h2>Instance Methods</h2><div id="disposeInternal" class="function"><div><h3>disposeInternal()<span class="codelink"><a href="source/closure/goog/net/filedownloader.js.src.html#l592">code »</a></span></h3><p><b>Overrides: </b><a href="class_goog_Disposable.html#disposeInternal">goog.Disposable</a></p></div></div><hr class="fn-sep"><div id="download" class="function"><div><h3>download(<wbr>url)<span class="codelink"><a href="source/closure/goog/net/filedownloader.js.src.html#l126">code »</a></span></h3><p>Download a remote file and save its contents to the filesystem. A given file is uniquely identified by its URL string; this means that the relative and absolute URLs for a single file are considered different for the purposes of the FileDownloader.</p><p>Returns a Deferred that will contain the downloaded blob. If there&#39;s an error while downloading the URL, this Deferred will be passed the <a href="class_goog_net_FileDownloader_Error.html"><code>goog.net.FileDownloader.Error</code></a> object as an errback.</p><p>If a download is already in progress for the given URL, this will return the deferred blob for that download. If the URL has already been downloaded, this will fail once it tries to save the downloaded blob.</p><p>When a download is in progress, all Deferreds returned for that download will be branches of a single parent. If all such branches are cancelled, or if one is cancelled with opt_deepCancel set, then the download will be cancelled as well.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>url<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The URL of the file to download.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>The deferred result blob.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getDownloadedBlob" class="function"><div><h3>getDownloadedBlob(<wbr>url)<span class="codelink"><a href="source/closure/goog/net/filedownloader.js.src.html#l181">code »</a></span></h3><p>Load a downloaded blob from the filesystem. Will fire a deferred error if the given URL has not yet been downloaded.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>url<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The URL of the blob to load.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>The deferred Blob object. The callback will be  passed the blob. If a file API error occurs while loading the blob, that  error will be passed to the errback.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getLocalUrl" class="function"><div><h3>getLocalUrl(<wbr>url)<span class="codelink"><a href="source/closure/goog/net/filedownloader.js.src.html#l204">code »</a></span></h3><p>Get the local filesystem: URL for a downloaded file. This is different from the blob: URL that&#39;s available from getDownloadedBlob(). If the end user accesses the filesystem: URL, the resulting file&#39;s name will be determined by the download filename as opposed to an arbitrary GUID. In addition, the filesystem: URL is connected to a filesystem location, so if the download is removed then that URL will become invalid.</p><p>Warning: in Chrome 12, some filesystem: URLs are opened inline. This means that e.g. HTML pages given to the user via filesystem: URLs will be opened and processed by the browser.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>url<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The URL of the file to get the URL of.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>The deferred filesystem: URL. The callback  will be passed the URL. If a file API error occurs while loading the  blob, that error will be passed to the errback.</p></dl></div></div></div></div><hr class="fn-sep"><div id="isDownloaded" class="function"><div><h3>isDownloaded(<wbr>url)<span class="codelink"><a href="source/closure/goog/net/filedownloader.js.src.html#l220">code »</a></span></h3><p>Return (deferred) whether or not a URL has been downloaded. Will fire a deferred error if something goes wrong when determining this.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>url<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The URL to check.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>The deferred boolean. The callback will be  passed the boolean. If a file API error occurs while checking the  existence of the downloaded URL, that error will be passed to the  errback.</p></dl></div></div></div></div><hr class="fn-sep"><div id="isDownloading" class="function"><div><h3>isDownloading(<wbr>url)<span class="codelink"><a href="source/closure/goog/net/filedownloader.js.src.html#l167">code »</a></span></h3><p>Returns whether or not there is an active download for a given URL.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>url<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The URL of the download to check.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether or not there is an active download for the URL.</p></dl></div></div></div></div><hr class="fn-sep"><div id="remove" class="function"><div><h3>remove(<wbr>url)<span class="codelink"><a href="source/closure/goog/net/filedownloader.js.src.html#l248">code »</a></span></h3><p>Remove a URL from the FileDownloader.</p><p>This returns a Deferred. If the removal is completed successfully, its callback will be called without any value. If the removal fails, its errback will be called with the <a href="class_goog_fs_Error.html"><code>goog.fs.Error</code></a>.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>url<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The URL to remove.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>The deferred used for registering callbacks on  success or on error.</p></dl></div></div></div></div><hr class="fn-sep"><div id="setBlob" class="function"><div><h3>setBlob(<wbr>url, blob, opt_name)<span class="codelink"><a href="source/closure/goog/net/filedownloader.js.src.html#l274">code »</a></span></h3><p>Save a blob for a given URL. This works just as through the blob were downloaded form that URL, except you specify the blob and no HTTP request is made.</p><p>If the URL is currently being downloaded, it&#39;s indeterminate whether the blob being set or the blob being downloaded will end up in the filesystem. Whichever one doesn&#39;t get saved will have an error. To ensure that one or the other takes precedence, use <a href="class_goog_net_FileDownloader.html#waitForDownload"><code>#waitForDownload</code></a> to allow the download to complete before setting the blob.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>url<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The URL at which to set the blob.</p><dt>blob<code>Blob</code><dd><p>The blob to set.</p><dt>opt_name<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>=</code><dd><p>The name of the file. If this isn&#39;t given, it&#39;s  determined from the URL.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>The deferred used for registering callbacks on  success or on error. This can be cancelled just like a <a href="class_goog_net_FileDownloader.html#download"><code>#download</code></a>  Deferred. The objects passed to the errback will be  <a href="class_goog_net_FileDownloader_Error.html"><code>goog.net.FileDownloader.Error</code></a>s.</p></dl></div></div></div></div><hr class="fn-sep"><div id="waitForDownload" class="function"><div><h3>waitForDownload(<wbr>url)<span class="codelink"><a href="source/closure/goog/net/filedownloader.js.src.html#l148">code »</a></span></h3><p>Return a Deferred that will fire once no download is active for a given URL. If there&#39;s no download active for that URL when this is called, the deferred will fire immediately; otherwise, it will fire once the download is complete, whether or not it succeeds.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>url<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The URL of the download to wait for.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>The Deferred that will fire when the download  is complete.</p></dl></div></div></div></div><h2>Types</h2><dl><dt><a href="class_goog_net_FileDownloader_Download_.html">FileDownloader.Download_</a><dd><p>A struct containing the data for a single download.</p><dt><a href="class_goog_net_FileDownloader_Error.html">FileDownloader.Error</a><dd><p>The error object for FileDownloader download errors.</p></dl></article><nav><h3><a href="index.html">Overview</a></h3><div><input type="checkbox" id="nav-types" checked/><label for="nav-types"><h3><span class="selectable">Types</span></h3></label><div id="nav-types-view"></div></div></nav></main><div class="pre-footer"><div></div></div><footer><div><a href="https://github.com/jleyba/js-dossier">Generated by dossier</a></div></footer><script src="types.js"></script><script src="dossier.js"></script>