<!DOCTYPE html><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"><meta http-equiv="Content-Language" content="en"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>PropertyReplacer</title><link href="dossier.css" rel="stylesheet" type="text/css"><header><div><form><div><input type="search" placeholder="Search"></div></form></div></header><main><article><div class="parentlink"><b>Namespace:</b> <a href="namespace_goog_testing.html">goog.testing</a></div><div class="codelink"><a href="source/closure/goog/testing/propertyreplacer.js.src.html#l66">View Source</a></div><h1>class PropertyReplacer</h1><div class="tags"><span>final</span></div><p>Helper class for stubbing out variables and object properties for unit tests. This class can change the value of some variables before running the test cases, and to reset them in the tearDown phase. See googletest.StubOutForTesting as an analogy in Python: http://protobuf.googlecode.com/svn/trunk/python/stubout.py</p><p>Example usage:</p>
<pre><code>var stubs &#61; new goog.testing.PropertyReplacer();

function setUp() {
  // Mock functions used in all test cases.
  stubs.set(Math, &#39;random&#39;, function() {
    return 4;  // Chosen by fair dice roll. Guaranteed to be random.
  });
}

function tearDown() {
  stubs.reset();
}

function testThreeDice() {
  // Mock a constant used only in this test case.
  stubs.set(goog.global, &#39;DICE_COUNT&#39;, 3);
  assertEquals(12, rollAllDice());
}
</code></pre><p>Constraints on altered objects: </p><ul><li>DOM subclasses aren&#39;t supported.  </li><li>The value of the objects&#39; constructor property must either be equal to  the real constructor or kept untouched. </li></ul><h2>Instance Methods</h2><div id="remove" class="function"><div><h3>remove(<wbr>obj, key)<span class="codelink"><a href="source/closure/goog/testing/propertyreplacer.js.src.html#l240">code »</a></span></h3><p>Deletes the key from the object while saving its original value.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>obj<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a></code><dd><p>The JavaScript or native object or function to  alter. See the constraints in the class description.</p><dt>key<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The key to delete.</p></dl></div></div></div></div><hr class="fn-sep"><div id="replace" class="function"><div><h3>replace(<wbr>obj, key, value)<span class="codelink"><a href="source/closure/goog/testing/propertyreplacer.js.src.html#l199">code »</a></span></h3><p>Changes an existing value in an object to another one of the same type while saving its original state. The advantage of <code>replace</code> over <a href="class_goog_testing_PropertyReplacer.html#set"><code>#set</code></a> is that <code>replace</code> protects against typos and erroneously passing tests after some members have been renamed during a refactoring.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>obj<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a></code><dd><p>The JavaScript or native object or function to  alter. See the constraints in the class description.</p><dt>key<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The key to change the value for. It has to be present  either in <code>obj</code> or in its prototype chain.</p><dt>value<code>*</code><dd><p>The new value to set. It has to have the same type as the  original value. The types are compared with <a href="namespace_goog.html#typeOf"><code>goog.typeOf</code></a>.</p></dl></div><div class="fn-details"><div><b>Throws</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a></code><dd><p>In case of missing key or type mismatch.</p></dl></div></div></div></div><hr class="fn-sep"><div id="reset" class="function"><div><h3>reset()<span class="codelink"><a href="source/closure/goog/testing/propertyreplacer.js.src.html#l251">code »</a></span></h3><p>Resets all changes made by goog.testing.PropertyReplacer.prototype.set.</p></div></div><hr class="fn-sep"><div id="set" class="function"><div><h3>set(<wbr>obj, key, value)<span class="codelink"><a href="source/closure/goog/testing/propertyreplacer.js.src.html#l169">code »</a></span></h3><p>Adds or changes a value in an object while saving its original state.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>obj<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a></code><dd><p>The JavaScript or native object or function to  alter. See the constraints in the class description.</p><dt>key<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The key to change the value for.</p><dt>value<code>*</code><dd><p>The new value to set.</p></dl></div><div class="fn-details"><div><b>Throws</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a></code><dd><p>In case of trying to set a read-only property.</p></dl></div></div></div></div><hr class="fn-sep"><div id="setPath" class="function"><div><h3>setPath(<wbr>path, value)<span class="codelink"><a href="source/closure/goog/testing/propertyreplacer.js.src.html#l217">code »</a></span></h3><p>Builds an object structure for the provided namespace path. Doesn&#39;t overwrite those prefixes of the path that are already objects or functions.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>path<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The path to create or alter, e.g. &#39;goog.ui.Menu&#39;.</p><dt>value<code>*</code><dd><p>The value to set.</p></dl></div></div></div></div></article><nav><h3><a href="index.html">Overview</a></h3><div><input type="checkbox" id="nav-types" checked/><label for="nav-types"><h3><span class="selectable">Types</span></h3></label><div id="nav-types-view"></div></div></nav></main><div class="pre-footer"><div></div></div><footer><div><a href="https://github.com/jleyba/js-dossier">Generated by dossier</a></div></footer><script src="types.js"></script><script src="dossier.js"></script>