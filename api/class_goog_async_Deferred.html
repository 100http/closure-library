<!DOCTYPE html><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"><meta http-equiv="Content-Language" content="en"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Deferred</title><link href="dossier.css" rel="stylesheet" type="text/css"><header><div><form><div><input type="search" placeholder="Search"></div></form></div></header><main><article><div class="parentlink"><b>Namespace:</b> <a href="namespace_goog_async.html">goog.async</a></div><div class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l78">View Source</a></div><h1>class Deferred&lt;VALUE&gt;</h1><dl><dt>All implemented interfaces:<dd><code><a href="interface_goog_Thenable.html">goog.Thenable</a>&lt;VALUE&gt;</code></dl><p>A Deferred represents the result of an asynchronous operation. A Deferred instance has no result when it is created, and is &#34;fired&#34; (given an initial result) by calling <code>callback</code> or <code>errback</code>.</p><p>Once fired, the result is passed through a sequence of callback functions registered with <code>addCallback</code> or <code>addErrback</code>. The functions may mutate the result before it is passed to the next function in the sequence.</p><p>Callbacks and errbacks may be added at any time, including after the Deferred has been &#34;fired&#34;. If there are no pending actions in the execution sequence of a fired Deferred, any new callback functions will be called with the last computed result. Adding a callback function is the only way to access the result of the Deferred.</p><p>If a Deferred operation is canceled, an optional user-provided cancellation function is invoked which may perform any special cleanup, followed by firing the Deferred&#39;s errback sequence with a <code>CanceledError</code>. If the Deferred has already fired, cancellation is ignored.</p><p>Deferreds may be templated to a specific type they produce using generics with syntax such as: <code>  /** &#64;type {goog.async.Deferred} */  var d &#61; new goog.async.Deferred();  // Compiler can infer that foo is a string.  d.addCallback(function(foo) {...});  d.callback(&#39;string&#39;); // Checked to be passed a string </code> Since deferreds are often used to produce different values across a chain, the type information is not propagated across chains, but rather only associated with specifically cast objects.</p><h2 class="main">new Deferred(<wbr>opt_onCancelFunction, opt_defaultScope)</h2><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>opt_onCancelFunction<code>?Function=</code><dd><p>A function that will be called if the  Deferred is canceled. If provided, this function runs before the  Deferred is fired with a <code>CanceledError</code>.</p><dt>opt_defaultScope<code>?<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>=</code><dd><p>The default object context to call  callbacks and errbacks in.</p></dl></div></div><h2>Instance Methods</h2><div id="addBoth" class="function"><div><h3><code>&lt;T&gt;</code> addBoth(<wbr>f, opt_scope)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l433">code »</a></span></h3><p>Registers one function as both a callback and errback.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>f<code>function(?): ?</code><dd><p>The function to be called on any result.</p><dt>opt_scope<code>T=</code><dd><p>An optional scope to call the function in.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>This Deferred.</p></dl></div></div></div></div><hr class="fn-sep"><div id="addCallback" class="function"><div><h3><code>&lt;T&gt;</code> addCallback(<wbr>cb, opt_scope)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l396">code »</a></span></h3><p>Register a callback function to be called with a successful result. If no value is returned by the callback function, the result value is unchanged. If a new value is returned, it becomes the Deferred result and will be passed to the next callback in the execution sequence.</p><p>If the function throws an error, the error becomes the new result and will be passed to the next errback in the execution chain.</p><p>If the function returns a Deferred, the execution sequence will be blocked until that Deferred fires. Its result will be passed to the next callback (or errback if it is an error result) in this Deferred&#39;s execution sequence.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>cb<code>function(VALUE): ?</code><dd><p>The function to be called with a  successful result.</p><dt>opt_scope<code>T=</code><dd><p>An optional scope to call the callback in.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>This Deferred.</p></dl></div></div></div></div><hr class="fn-sep"><div id="addCallbacks" class="function"><div><h3><code>&lt;T&gt;</code> addCallbacks(<wbr>cb, eb, opt_scope)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l474">code »</a></span></h3><p>Registers a callback function and an errback function at the same position in the execution sequence. Only one of these functions will execute, depending on the error state during the execution sequence.</p><p>NOTE: This is not equivalent to <code>def.addCallback().addErrback()</code>! If the callback is invoked, the errback will be skipped, and vice versa.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>cb<code>?function(VALUE): ?</code><dd><p>The function to be called on a  successful result.</p><dt>eb<code>?function(?): ?</code><dd><p>The function to be called on an  unsuccessful result.</p><dt>opt_scope<code>T=</code><dd><p>An optional scope to call the functions in.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>This Deferred.</p></dl></div></div></div></div><hr class="fn-sep"><div id="addErrback" class="function"><div><h3><code>&lt;T&gt;</code> addErrback(<wbr>eb, opt_scope)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l420">code »</a></span></h3><p>Register a callback function to be called with an error result. If no value is returned by the function, the error result is unchanged. If a new error value is returned or thrown, that error becomes the Deferred result and will be passed to the next errback in the execution sequence.</p><p>If the errback function handles the error by returning a non-error value, that result will be passed to the next normal callback in the sequence.</p><p>If the function returns a Deferred, the execution sequence will be blocked until that Deferred fires. Its result will be passed to the next callback (or errback if it is an error result) in this Deferred&#39;s execution sequence.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>eb<code>function(?): ?</code><dd><p>The function to be called on an  unsuccessful result.</p><dt>opt_scope<code>T=</code><dd><p>An optional scope to call the errback in.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a>&lt;VALUE&gt;</code><dd><p>This Deferred.</p></dl></div></div></div></div><hr class="fn-sep"><div id="addFinally" class="function"><div><h3><code>&lt;T&gt;</code> addFinally(<wbr>f, opt_scope)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l446">code »</a></span></h3><p>Like addBoth, but propagates uncaught exceptions in the errback.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>f<code>function(?): ?</code><dd><p>The function to be called on any result.</p><dt>opt_scope<code>T=</code><dd><p>An optional scope to call the function in.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a>&lt;VALUE&gt;</code><dd><p>This Deferred.</p></dl></div></div></div></div><hr class="fn-sep"><div id="awaitDeferred" class="function"><div><h3>awaitDeferred(<wbr>otherDeferred)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l543">code »</a></span></h3><p>Makes this Deferred wait for another Deferred&#39;s execution sequence to complete before continuing.</p><p>This is equivalent to adding a callback that returns <code>otherDeferred</code>, but doesn&#39;t prevent additional callbacks from being added to <code>otherDeferred</code>.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>otherDeferred<code>(<a href="class_goog_async_Deferred.html">goog.async.Deferred</a>|<a href="interface_goog_Thenable.html">goog.Thenable</a>)</code><dd><p>The Deferred  to wait for.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>This Deferred.</p></dl></div></div></div></div><hr class="fn-sep"><div id="branch" class="function"><div><h3>branch(<wbr>opt_propagateCancel)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l569">code »</a></span></h3><p>Creates a branch off this Deferred&#39;s execution sequence, and returns it as a new Deferred. The branched Deferred&#39;s starting result will be shared with the parent at the point of the branch, even if further callbacks are added to the parent.</p><p>All branches at the same stage in the execution sequence will receive the same starting value.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>opt_propagateCancel<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a>=</code><dd><p>If cancel() is called on every child  branch created with opt_propagateCancel, the parent will be canceled as  well.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a>&lt;VALUE&gt;</code><dd><p>A Deferred that will be started with  the computed result from this stage in the execution sequence.</p></dl></div></div></div></div><hr class="fn-sep"><div id="callback" class="function"><div><h3>callback(<wbr>opt_result)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l323">code »</a></span></h3><p>Fire the execution sequence for this Deferred by passing the starting result to the first registered callback.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>opt_result<code>VALUE=</code><dd><p>The starting result.</p></dl></div></div></div></div><hr class="fn-sep"><div id="cancel" class="function"><div><h3>cancel(<wbr>opt_deepCancel)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l228">code »</a></span></h3><p>Cancels a Deferred that has not yet been fired, or is blocked on another deferred operation. If this Deferred is waiting for a blocking Deferred to fire, the blocking Deferred will also be canceled.</p><p>If this Deferred was created by calling branch() on a parent Deferred with opt_propagateCancel set to true, the parent may also be canceled. If opt_deepCancel is set, cancel() will be called on the parent (as well as any other ancestors if the parent is also a branch). If one or more branches were created with opt_propagateCancel set to true, the parent will be canceled if cancel() is called on all of those branches.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>opt_deepCancel<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a>=</code><dd><p>If true, cancels this Deferred&#39;s parent even  if cancel() hasn&#39;t been called on some of the parent&#39;s branches. Has no  effect on a branch without opt_propagateCancel set to true.</p></dl></div></div></div></div><hr class="fn-sep"><div id="chainDeferred" class="function"><div><h3>chainDeferred(<wbr>otherDeferred)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l524">code »</a></span></h3><p>Links another Deferred to the end of this Deferred&#39;s execution sequence. The result of this execution sequence will be passed as the starting result for the chained Deferred, invoking either its first callback or errback.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>otherDeferred<code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>The Deferred to chain.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>This Deferred.</p></dl></div></div></div></div><hr class="fn-sep"><div id="errback" class="function"><div><h3>errback(<wbr>opt_result)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l335">code »</a></span></h3><p>Fire the execution sequence for this Deferred by passing the starting error result to the first registered errback.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>opt_result<code>*=</code><dd><p>The starting error.</p></dl></div></div></div></div><hr class="fn-sep"><div id="hasFired" class="function"><div><h3>hasFired()<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l584">code »</a></span></h3><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether the execution sequence has been started on this  Deferred by invoking <code>callback</code> or <code>errback</code>.</p></dl></div></div></div></div><hr class="fn-sep"><div id="isError" class="function"><div><h3>isError(<wbr>res)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l596">code »</a></span></h3><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>res<code>*</code><dd><p>The latest result in the execution sequence.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether the current result is an error that should cause  the next errback to fire. May be overridden by subclasses to handle  special error types.</p></dl></div></div></div></div><hr class="fn-sep"><div id="then" class="function"><div><h3>then(<wbr>opt_onFulfilled, opt_onRejected, opt_context)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l495">code »</a></span></h3><p>Implements goog.Thenable for seamless integration with goog.Promise. Deferred results are mutable and may represent multiple values over their lifetime. Calling <code>then</code> on a Deferred returns a Promise with the result of the Deferred at that point in its callback chain. Note that if the Deferred result is never mutated, and only <code>then</code> calls are made, the Deferred will behave like a Promise.</p><p><b>Specified by: </b><a href="interface_goog_Thenable.html#then">goog.Thenable</a></p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>opt_onFulfilled<code>?function(VALUE): ?(RESULT|IThenable&lt;RESULT&gt;|{then: Function})=</code><dt>opt_onRejected<code>?function(*): *=</code><dt>opt_context<code>THIS=</code></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_Promise.html">goog.Promise</a></code></dl></div></div></div></div><h2>Static Functions</h2><div id="Deferred.assertNoErrors" class="function"><div><h3>Deferred.assertNoErrors()<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l939">code »</a></span></h3><p>Asserts that there are no pending deferred errors. If there are any scheduled errors, one will be thrown immediately to make this function fail.</p></div></div><hr class="fn-sep"><div id="Deferred.canceled" class="function"><div><h3>Deferred.canceled()<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l756">code »</a></span></h3><p>Creates a Deferred that has already been canceled.</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>The new Deferred.</p></dl></div></div></div></div><hr class="fn-sep"><div id="Deferred.fail" class="function"><div><h3>Deferred.fail(<wbr>res)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l744">code »</a></span></h3><p>Creates a Deferred that has an initial error result.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>res<code>*</code><dd><p>The error result.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>The new Deferred.</p></dl></div></div></div></div><hr class="fn-sep"><div id="Deferred.fromPromise" class="function"><div><h3><code>&lt;T&gt;</code> Deferred.fromPromise(<wbr>promise)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l728">code »</a></span></h3><p>Creates a Deferred that fires when the given promise resolves. Use only during migration to Promises.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>promise<code><a href="class_goog_Promise.html">goog.Promise</a>&lt;T, ?&gt;</code></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a>&lt;T&gt;</code><dd><p>The new Deferred.</p></dl></div></div></div></div><hr class="fn-sep"><div id="Deferred.succeed" class="function"><div><h3>Deferred.succeed(<wbr>opt_result)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l713">code »</a></span></h3><p>Creates a Deferred that has an initial result.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>opt_result<code>*=</code><dd><p>The result.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>The new Deferred.</p></dl></div></div></div></div><hr class="fn-sep"><div id="Deferred.when" class="function"><div><h3><code>&lt;T&gt;</code> Deferred.when(<wbr>value, callback, opt_scope)<span class="codelink"><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l795">code »</a></span></h3><p>Normalizes values that may or may not be Deferreds.</p><p>If the input value is a Deferred, the Deferred is branched (so the original execution sequence is not modified) and the input callback added to the new branch. The branch is returned to the caller.</p><p>If the input value is not a Deferred, the callback will be executed immediately and an already firing Deferred will be returned to the caller.</p><p>In the following (contrived) example, if <code>isImmediate</code> is true then 3 is alerted immediately, otherwise 6 is alerted after a 2-second delay.</p>
<pre>
var value;
if (isImmediate) {
  value &#61; 3;
} else {
  value &#61; new goog.async.Deferred();
  setTimeout(function() { value.callback(6); }, 2000);
}

var d &#61; goog.async.Deferred.when(value, alert);
</pre><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>value<code>*</code><dd><p>Deferred or normal value to pass to the callback.</p><dt>callback<code>function(?): ?</code><dd><p>The callback to execute.</p><dt>opt_scope<code>T=</code><dd><p>An optional scope to call the callback in.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_async_Deferred.html">goog.async.Deferred</a></code><dd><p>A new Deferred that will call the input  callback with the input value.</p></dl></div></div></div></div><h2>Compiler Constants</h2><div id="Deferred.LONG_STACK_TRACES" class="property"><dl><dt><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l209">Deferred.LONG_STACK_TRACES</a><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether to attempt to make stack traces long. Defaults to the value of goog.DEBUG.</p></dl></div><div id="Deferred.STRICT_ERRORS" class="property"><dl><dt><a href="source/third_party/closure/goog/mochikit/async/deferred.js.src.html#l202">Deferred.STRICT_ERRORS</a><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether unhandled errors should always get rethrown to the global scope. Defaults to the value of goog.DEBUG.</p></dl></div><h2>Types</h2><dl><dt><a href="class_goog_async_Deferred_AlreadyCalledError.html">Deferred.AlreadyCalledError</a><dd><p>An error sub class that is used when a Deferred has already been called.</p><dt><a href="class_goog_async_Deferred_CanceledError.html">Deferred.CanceledError</a><dd><p>An error sub class that is used when a Deferred is canceled.</p><dt><a href="class_goog_async_Deferred_Error_.html">Deferred.Error_</a><dd><p>Wrapper around errors that are scheduled to be thrown by failing deferreds after a timeout.</p></dl></article><nav><h3><a href="index.html">Overview</a></h3><div><input type="checkbox" id="nav-types" checked/><label for="nav-types"><h3><span class="selectable">Types</span></h3></label><div id="nav-types-view"></div></div></nav></main><div class="pre-footer"><div></div></div><footer><div><a href="https://github.com/jleyba/js-dossier">Generated by dossier</a></div></footer><script src="types.js"></script><script src="dossier.js"></script>