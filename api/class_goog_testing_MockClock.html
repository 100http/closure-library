<!DOCTYPE html><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"><meta http-equiv="Content-Language" content="en"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>MockClock</title><link href="dossier.css" rel="stylesheet" type="text/css"><header><div><form><div><input type="search" placeholder="Search"></div></form></div></header><main><article><div class="parentlink"><b>Namespace:</b> <a href="namespace_goog_testing.html">goog.testing</a></div><div class="codelink"><a href="source/closure/goog/testing/mockclock.js.src.html#l59">View Source</a></div><h1>class MockClock</h1><div class="tags"><span>final</span></div><pre class="inheritance"><a href="class_goog_Disposable.html">goog.Disposable</a>
  &#x2514; goog.testing.MockClock</pre><dl><dt>All implemented interfaces:<dd><code><a href="interface_goog_disposable_IDisposable.html">goog.disposable.IDisposable</a></code></dl><p>Class for unit testing code that uses setTimeout and clearTimeout.</p><p>NOTE: If you are using MockClock to test code that makes use of  goog.fx.Animation, then you must either:</p>
<ol><li>Install and dispose of the MockClock in setUpPage() and tearDownPage()  respectively (rather than setUp()/tearDown()).</li></ol><p>or</p>
<ol><li>Ensure that every test clears the animation queue by calling  mockClock.tick(x) at the end of each test function (where <code>x</code> is large  enough to complete all animations).</li></ol><p>Otherwise, if any animation is left pending at the time that MockClock.dispose() is called, that will permanently prevent any future animations from playing on the page.</p><h2 class="main">new MockClock(<wbr>opt_autoInstall)</h2><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>opt_autoInstall<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a>=</code><dd><p>Install the MockClock at construction time.</p></dl></div></div><h2>Instance Methods</h2><div id="disposeInternal" class="function"><div><h3>disposeInternal()<span class="codelink"><a href="source/closure/goog/testing/mockclock.js.src.html#l254">code »</a></span></h3><p><b>Overrides: </b><a href="class_goog_Disposable.html#disposeInternal">goog.Disposable</a></p></div></div><hr class="fn-sep"><div id="fireResetEvent" class="function"><div><h3>fireResetEvent()<span class="codelink"><a href="source/closure/goog/testing/mockclock.js.src.html#l281">code »</a></span></h3><p>Signals that the mock clock has been reset, allowing objects that maintain their own internal state to reset.</p></div></div><hr class="fn-sep"><div id="getCurrentTime" class="function"><div><h3>getCurrentTime()<span class="codelink"><a href="source/closure/goog/testing/mockclock.js.src.html#l372">code »</a></span></h3><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The MockClock&#39;s current time in milliseconds.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getTimeoutDelay" class="function"><div><h3>getTimeoutDelay()<span class="codelink"><a href="source/closure/goog/testing/mockclock.js.src.html#l301">code »</a></span></h3><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>delay The amount of time between when a timeout is  scheduled to fire and when it actually fires, in milliseconds. May  be negative.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getTimeoutsMade" class="function"><div><h3>getTimeoutsMade()<span class="codelink"><a href="source/closure/goog/testing/mockclock.js.src.html#l364">code »</a></span></h3><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The number of timeouts that have been scheduled.</p></dl></div></div></div></div><hr class="fn-sep"><div id="install" class="function"><div><h3>install()<span class="codelink"><a href="source/closure/goog/testing/mockclock.js.src.html#l167">code »</a></span></h3><p>Installs the MockClock by overriding the global object&#39;s implementation of setTimeout, setInterval, clearTimeout and clearInterval.</p></div></div><hr class="fn-sep"><div id="isTimeoutSet" class="function"><div><h3>isTimeoutSet(<wbr>timeoutKey)<span class="codelink"><a href="source/closure/goog/testing/mockclock.js.src.html#l386">code »</a></span></h3><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>timeoutKey<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The timeout key.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether the timer has been set and not cleared,  independent of the timeout&#39;s expiration. In other words, the timeout  could have passed or could be scheduled for the future. Either way,  this function returns true or false depending only on whether the  provided timeoutKey represents a timeout that has been set and not  cleared.</p></dl></div></div></div></div><hr class="fn-sep"><div id="reset" class="function"><div><h3>reset()<span class="codelink"><a href="source/closure/goog/testing/mockclock.js.src.html#l266">code »</a></span></h3><p>Resets the MockClock, removing all timeouts that are scheduled and resets the fake timer count.</p></div></div><hr class="fn-sep"><div id="setTimeoutDelay" class="function"><div><h3>setTimeoutDelay(<wbr>delay)<span class="codelink"><a href="source/closure/goog/testing/mockclock.js.src.html#l291">code »</a></span></h3><p>Sets the amount of time between when a timeout is scheduled to fire and when it actually fires.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>delay<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The delay in milliseconds. May be negative.</p></dl></div></div></div></div><hr class="fn-sep"><div id="tick" class="function"><div><h3>tick(<wbr>opt_millis)<span class="codelink"><a href="source/closure/goog/testing/mockclock.js.src.html#l313">code »</a></span></h3><p>Increments the MockClock&#39;s time by a given number of milliseconds, running any functions that are now overdue.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>opt_millis<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a>=</code><dd><p>Number of milliseconds to increment the counter.  If not specified, clock ticks 1 millisecond.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>Current mock time in milliseconds.</p></dl></div></div></div></div><hr class="fn-sep"><div id="tickPromise" class="function"><div><h3><code>&lt;T&gt;</code> tickPromise(<wbr>promise, opt_millis)<span class="codelink"><a href="source/closure/goog/testing/mockclock.js.src.html#l338">code »</a></span></h3><p>Takes a promise and then ticks the mock clock. If the promise successfully resolves, returns the value produced by the promise. If the promise is rejected, it throws the rejection as an exception. If the promise is not resolved at all, throws an exception. Also ticks the general clock by the specified amount.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>promise<code><a href="interface_goog_Thenable.html">goog.Thenable</a>&lt;T&gt;</code><dd><p>A promise that should be resolved after  the mockClock is ticked for the given opt_millis.</p><dt>opt_millis<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a>=</code><dd><p>Number of milliseconds to increment the counter.  If not specified, clock ticks 1 millisecond.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code>T</code></dl></div></div></div></div><hr class="fn-sep"><div id="uninstall" class="function"><div><h3>uninstall()<span class="codelink"><a href="source/closure/goog/testing/mockclock.js.src.html#l242">code »</a></span></h3><p>Removes the MockClock&#39;s hooks into the global object&#39;s functions and revert to their original values.</p></div></div><h2>Static Properties</h2><div id="MockClock.REQUEST_ANIMATION_FRAME_TIMEOUT" class="property"><dl><dt><a href="source/closure/goog/testing/mockclock.js.src.html#l100">MockClock.REQUEST_ANIMATION_FRAME_TIMEOUT</a><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>Default wait timeout for mocking requestAnimationFrame (in milliseconds).</p></dl></div><div id="MockClock.nextId" class="property"><dl><dt><a href="source/closure/goog/testing/mockclock.js.src.html#l108">MockClock.nextId</a><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>ID to use for next timeout. Timeout IDs must never be reused, even across MockClock instances.</p></dl></div></article><nav><h3><a href="index.html">Overview</a></h3><div><input type="checkbox" id="nav-types" checked/><label for="nav-types"><h3><span class="selectable">Types</span></h3></label><div id="nav-types-view"></div></div></nav></main><div class="pre-footer"><div></div></div><footer><div><a href="https://github.com/jleyba/js-dossier">Generated by dossier</a></div></footer><script src="types.js"></script><script src="dossier.js"></script>