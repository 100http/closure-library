<!DOCTYPE html><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"><meta http-equiv="Content-Language" content="en"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>BroadcastPubSub</title><link href="dossier.css" rel="stylesheet" type="text/css"><header><div><form><div><input type="search" placeholder="Search"></div></form></div></header><main><article><div class="parentlink"><b>Namespace:</b> <a href="namespace_goog_labs_pubsub.html">goog.labs.pubsub</a></div><div class="codelink"><a href="source/closure/goog/labs/pubsub/broadcastpubsub.js.src.html#l66">View Source</a></div><h1>class BroadcastPubSub</h1><div class="tags"><span>struct</span></div><pre class="inheritance"><a href="class_goog_Disposable.html">goog.Disposable</a>
  &#x2514; goog.labs.pubsub.BroadcastPubSub</pre><dl><dt>All implemented interfaces:<dd><code><a href="interface_goog_disposable_IDisposable.html">goog.disposable.IDisposable</a></code></dl><p>Topic-based publish/subscribe messaging implementation that provides communication between browsing contexts that share the same origin.</p><p>Wrapper around PubSub that utilizes localStorage to broadcast publications to all browser windows with the same origin as the publishing context. This allows for topic-based publish/subscribe implementation of strings shared by all browser contexts that share the same origin.</p><p>Delivery is guaranteed on all browsers except IE8 where topics expire after a timeout. Publishing of a topic within a callback function provides no guarantee on ordering in that there is a possiblilty that separate origin contexts may see topics in a different order.</p><p>This class is not secure and in certain cases (e.g., a browser crash) data that is published can persist in localStorage indefinitely. Do not use this class to communicate private or confidential information.</p><p>On IE8, localStorage is shared by the http and https origins. An attacker could possibly leverage this to publish to the secure origin.</p><p>goog.labs.pubsub.BroadcastPubSub wraps an instance of PubSub rather than subclassing because the base PubSub class allows publishing of arbitrary objects.</p><p>Special handling is done for the IE8 browsers. See the IE8_EVENTS_KEY_ constant and the <code>publish</code> function for more information.</p><h2>Instance Methods</h2><div id="clear" class="function"><div><h3>clear(<wbr>opt_topic)<span class="codelink"><a href="source/closure/goog/labs/pubsub/broadcastpubsub.js.src.html#l323">code »</a></span></h3><p>Clears the subscription list for a topic, or all topics if unspecified.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>opt_topic<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>=</code><dd><p>Topic to clear (all topics if unspecified).</p></dl></div></div></div></div><hr class="fn-sep"><div id="disposeInternal" class="function"><div><h3>disposeInternal()<span class="codelink"><a href="source/closure/goog/labs/pubsub/broadcastpubsub.js.src.html#l329">code »</a></span></h3><p><b>Overrides: </b><a href="class_goog_Disposable.html#disposeInternal">goog.Disposable</a></p></div></div><hr class="fn-sep"><div id="getCount" class="function"><div><h3>getCount(<wbr>opt_topic)<span class="codelink"><a href="source/closure/goog/labs/pubsub/broadcastpubsub.js.src.html#l314">code »</a></span></h3><p>Returns the number of subscriptions to the given topic (or all topics if unspecified). This number will not change while publishing any messages.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>opt_topic<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>=</code><dd><p>The topic (all topics if unspecified).</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>Number of subscriptions to the topic.</p></dl></div></div></div></div><hr class="fn-sep"><div id="publish" class="function"><div><h3>publish(<wbr>topic, var_args)<span class="codelink"><a href="source/closure/goog/labs/pubsub/broadcastpubsub.js.src.html#l169">code »</a></span></h3><p>Publishes a message to a topic. Remote subscriptions in other tabs/windows are dispatched via local storage events. Local subscriptions are called asynchronously via Timer event in order to simulate remote behavior locally.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>topic<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>Topic to publish to.</p><dt>var_args<code>...<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>String arguments that are applied to each  subscription function.</p></dl></div></div></div></div><hr class="fn-sep"><div id="subscribe" class="function"><div><h3>subscribe(<wbr>topic, fn, opt_context)<span class="codelink"><a href="source/closure/goog/labs/pubsub/broadcastpubsub.js.src.html#l283">code »</a></span></h3><p>Subscribes a function to a topic. The function is invoked as a method on the given <code>opt_context</code> object, or in the global scope if no context is specified. Subscribing the same function to the same topic multiple times will result in multiple function invocations while publishing. Returns a subscription key that can be used to unsubscribe the function from the topic via <a href="class_goog_labs_pubsub_BroadcastPubSub.html#unsubscribeByKey"><code>#unsubscribeByKey</code></a>.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>topic<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>Topic to subscribe to.</p><dt>fn<code>Function</code><dd><p>Function to be invoked when a message is published to  the given topic.</p><dt>opt_context<code>?<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>=</code><dd><p>Object in whose context the function is to be  called (the global scope if none).</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>Subscription key.</p></dl></div></div></div></div><hr class="fn-sep"><div id="subscribeOnce" class="function"><div><h3>subscribeOnce(<wbr>topic, fn, opt_context)<span class="codelink"><a href="source/closure/goog/labs/pubsub/broadcastpubsub.js.src.html#l302">code »</a></span></h3><p>Subscribes a single-use function to a topic. The function is invoked as a method on the given <code>opt_context</code> object, or in the global scope if no context is specified, and is then unsubscribed. Returns a subscription key that can be used to unsubscribe the function from the topic via <a href="class_goog_labs_pubsub_BroadcastPubSub.html#unsubscribeByKey"><code>#unsubscribeByKey</code></a>.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>topic<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>Topic to subscribe to.</p><dt>fn<code>Function</code><dd><p>Function to be invoked once and then unsubscribed when  a message is published to the given topic.</p><dt>opt_context<code>?<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>=</code><dd><p>Object in whose context the function is to be  called (the global scope if none).</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>Subscription key.</p></dl></div></div></div></div><hr class="fn-sep"><div id="unsubscribe" class="function"><div><h3>unsubscribe(<wbr>topic, fn, opt_context)<span class="codelink"><a href="source/closure/goog/labs/pubsub/broadcastpubsub.js.src.html#l251">code »</a></span></h3><p>Unsubscribes a function from a topic. Only deletes the first match found. Returns a Boolean indicating whether a subscription was removed.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>topic<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>Topic to unsubscribe from.</p><dt>fn<code>Function</code><dd><p>Function to unsubscribe.</p><dt>opt_context<code>?<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>=</code><dd><p>Object in whose context the function was to be  called (the global scope if none).</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether a matching subscription was removed.</p></dl></div></div></div></div><hr class="fn-sep"><div id="unsubscribeByKey" class="function"><div><h3>unsubscribeByKey(<wbr>key)<span class="codelink"><a href="source/closure/goog/labs/pubsub/broadcastpubsub.js.src.html#l264">code »</a></span></h3><p>Removes a subscription based on the key returned by <a href="class_goog_labs_pubsub_BroadcastPubSub.html#subscribe"><code>#subscribe</code></a>. No-op if no matching subscription is found. Returns a Boolean indicating whether a subscription was removed.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>key<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>Subscription key.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether a matching subscription was removed.</p></dl></div></div></div></div><h2>Type Definitions</h2><div id="BroadcastPubSub.Ie8Event_" class="property"><dl><dt><a href="source/closure/goog/labs/pubsub/broadcastpubsub.js.src.html#l402">BroadcastPubSub.Ie8Event_</a><code>{args: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a>&lt;<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>&gt;, timestamp: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a>}</code><dd><p>All instances of this object should access elements using strings and not attributes. Since we are communicating across browser tabs we could be dealing with different versions of javascript and thus may have different obfuscation in each tab.</p></dl></div></article><nav><h3><a href="index.html">Overview</a></h3><div><input type="checkbox" id="nav-types" checked/><label for="nav-types"><h3><span class="selectable">Types</span></h3></label><div id="nav-types-view"></div></div></nav></main><div class="pre-footer"><div></div></div><footer><div><a href="https://github.com/jleyba/js-dossier">Generated by dossier</a></div></footer><script src="types.js"></script><script src="dossier.js"></script>